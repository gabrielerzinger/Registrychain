<div *ngIf="user" class="container">
	<div class="row my-2 mx-0 pt-5">
		<div class="col-xs-12 col-sm-4 col-lg-3 text-center">
			<img src="//placehold.it/150" class="mx-auto rounded" alt="avatar">
			<p class="mt-2">Olá, {{user.name.split(' ')[0]}}!</p>
		</div>
		<div class="col-xs-12 col-sm-8 col-lg-9">
			<tabset>
				<tab heading="Perfil">
					<div class="tab-content py-4">
						<div class="tab-pane active">
							<h3 class="mb-5">Seja Bem-Vindo, {{user.name}}!</h3>
							<div class="row mx-0">
								<div class="col-sm-12">
									<h4 class="mb-3">Seus Dados:</h4>
									<div class="row mx-0">
										<div class="col-sm-3">
											<strong>CPF:</strong>
										</div>
										<div class="col-sm-9">
											{{user.cpf}}
										</div>
									</div>
									<div class="row mx-0">
										<div class="col-sm-3">
											<strong>Email:</strong>
										</div>
										<div class="col-sm-9">
											{{user.email}}
										</div>
									</div>
									<div class="row mx-0 pt-4">
										<div class="col-sm-4">
											<h5>Chave Pública:</h5>
										</div>
									</div>
									<div class="row">
										<div class="col-sm-12">
											<img id="qrcode" [src]="user.pubkeyurl">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</tab>
				<tab heading="Contratos">
					<div class="tab-pane">
						<div class="p-3">
							<h4>Contratos Pendentes</h4>
							<table class="table table-hover table-striped mt-3">
								<thead>
									<tr>
										<th>Contrato ID</th>
										<th>Contraparte</th>
										<th>Ação</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let c of pendingContracts">
										<td><a href="javascript:void(0);" (click)="selectedContract=c; contractModal.show()">{{c._id}}</a></td>
										<td>{{c.hirer == user._id ? c.hired : c.hirer}}</td>
										<td>
											<button class="btn btn-success"  (click)="accept(c)">Aceitar</button>
											<button class="btn btn-danger ml-2" (click)="refuse(c)">Rejeitar</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="p-3">
							<h4>Contratos Celebrados</h4>
							<table class="table table-hover table-striped mt-3">
								<thead>
									<tr>
										<th>Contrato ID</th>
										<th>Contraparte</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let c of myContracts">
										<td><a href="javascript:void(0);" (click)="selectedContract=c; contractModal.show()">{{c._id}}</a></td>
										<td>{{c.hirer == user._id ? c.hired : c.hirer}}</td>
									</tr>
								</tbody>
							</table>
							<div class="btn-group" dropdown>
								<button id="button-basic" dropdownToggle type="button" class="btn btn-primary dropdown-toggle">
									Novo Contrato <span class="caret"></span>
								</button>
								<ul id="dropdown-basic" *dropdownMenu class="dropdown-menu" role="menu">
									<li role="menuItem"><a class="dropdown-item" routerLink="/c2c">Pessoa Física</a></li>
									<li role="menuItem"><a class="dropdown-item" href="#">Compra &amp; Venda</a></li>
									<li role="menuItem"><a class="dropdown-item" href="#">União Estável</a></li>
								</ul>
							</div>
						</div>
					</div>
				</tab>
			</tabset>
		</div>
	</div>
</div>

<div class="modal fade" bsModal #contractModal="bs-modal" tabindex="-1">
	<div class="modal-dialog" *ngIf="selectedContract">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title pull-left">Contract {{ selectedContract._id }}</h4>
				<button type="button" class="close pull-right" (click)="contractModal.hide()">
					<span>&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<table class="table mt-3">
					<tbody>
						<tr>
							<td>Contratado</td>
							<td>{{selectedContract.hired}}</td>
						</tr>
						<tr>
							<td>Contratante</td>
							<td>{{selectedContract.hirer}}</td>
						</tr>
						<tr>
							<td>Descrição</td>
							<td>{{selectedContract.description}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
