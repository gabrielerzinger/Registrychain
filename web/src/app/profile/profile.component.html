<div *ngIf="user" class="container">
	<div class="row my-2" style="padding-top: 12%;">
		<div class="col-lg-8  col-sm-12 order-lg-2">
			<tabset>
				<tab heading="Perfil">
					<div class="tab-content py-4">
						<div class="tab-pane active">
							<h5 class="mb-3">{{user.name}}</h5>
							<div class="row">
								<div class="col-lg-6 col-sm-12">
									<h6>Dados</h6>
									<div class="row">
										<div class="col-md-6 col-sm-6">
											<strong>CPF:</strong> {{user.cpf.substr(0, user.cpf.length - 3) + "#-##"}}
										</div>
									</div>
									<h6>Chave pública</h6>
									<div class="col-md-12">
										<p><img id="qrcode" [src]="user.pubkeyurl"></p>
										<p><strong>Email: {{user.email}} </strong></p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</tab>
				<tab heading="Contratos">
					<div class="tab-pane">
						<div class="p-3">
							<h4>Contratos Pendentes</h4>
							<table class="table table-hover table-striped mt-3">
								<thead>
									<tr>
										<th>Contrato ID</th>
										<th>Contraparte</th>
										<th>Ação</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let c of pendingContracts">
										<td><a href="javascript:void(0);" (click)="selectedContract=c; contractModal.show()">{{c._id}}</a></td>
										<td>{{c.hirer == user._id ? c.hired : c.hirer}}</td>
										<td>
											<button class="btn btn-success"  (click)="accept(c)">Aceitar</button>
											<button class="btn btn-danger ml-2" (click)="refuse(c)">Rejeitar</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="p-3">
							<h4>Contratos Celebrados</h4>
							<table class="table table-hover table-striped mt-3">
								<thead>
									<tr>
										<th>Contrato ID</th>
										<th>Contraparte</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let c of myContracts">
										<td><a href="javascript:void(0);" (click)="selectedContract=c; contractModal.show()">{{c._id}}</a></td>
										<td>{{c.hirer == user._id ? c.hired : c.hirer}}</td>
									</tr>
								</tbody>
							</table>
							<button class="btn btn-primary" routerLink="/c2c">Novo Contrato</button>
						</div>
					</div>
				</tab>
			</tabset>
		</div>
		<div class="col-lg-4 col-sm-12 order-lg-1 text-center ">
			<img src="//placehold.it/150" class="mx-auto img-fluid img-circle d-block" alt="avatar">
		</div>
	</div>
</div>

<div class="modal fade" bsModal #contractModal="bs-modal" tabindex="-1">
	<div class="modal-dialog" *ngIf="selectedContract">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title pull-left">Contract {{ selectedContract._id }}</h4>
				<button type="button" class="close pull-right" (click)="contractModal.hide()">
					<span>&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<table class="table mt-3">
					<tbody>
						<tr>
							<td>Contratado</td>
							<td>{{selectedContract.hired}}</td>
						</tr>
						<tr>
							<td>Contratante</td>
							<td>{{selectedContract.hirer}}</td>
						</tr>
						<tr>
							<td>Descrição</td>
							<td>{{selectedContract.description}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
